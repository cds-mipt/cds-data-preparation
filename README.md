# cds-data-preparation
Данный репозиторий создан для того, чтобы облегчить работу с DTLD датасатом.
DTLD датасет - это датасет светофоров сделаный университетом Ульма.
Среди других датасетов его выделяют качественная разметка - в нем светофоры размеченны по целым 6 категориям, среди которых:   
* позиция
* релевантность
* положение
* количество сигналов
* сигнал
* пиктограмма

Данный датасет можно бесплатно скачать, для этого нужно оставить запрос у его создателей:    
https://www.uni-ulm.de/en/in/driveu/projects/driveu-traffic-light-dataset/

## crop_light.py
Этот скрипт используется для получения датасета из светофоров.   
На вход он принимает следующие параметры:
* `folder-train`
* `folder-test`
* `attitude`
* `input-file`

`folder-train` - путь папки в которую будет записываться датасет для обучения сетки, если папка не существует, то она будет создана автоматически   
`folder-test` - путь папки в которую будет записываться датасет для валидации сетки, если папка не существует, то она будет создана автоматически   
`attitude` - отношение `train` к `train+test` (например: при `attitude=0.7` 70% информации будет записано в `folder-train`) дефолтное значение `attitude` равняется `0.8` 
`input-file` - файл типа `JSON` в котором находятся аннотации к городу/городам/всему_датасету   

### Пример использования
`python crop_light.py --output-folder-test /datasets/DTLD/DTLD_crop/test --output-folder-train /datasets/DTLD/DTLD_crop/train --attitude 0.9 --input-file /datasets/DTLD/JSONS/Bochum_all.json`

#### Важно! Для корректной работы в JSON файлах должны быть прописаны правильные `path` файлов в аннотациях


## parser3.py
Этот скрипт предназначен для создания аннотаций в формате COCO из JSON файлов.   
На вход он принимает следующие параметры:
* `input-file`
* `output-folder`
* `ann-name`
* `attitude`

`input-file` - файл в формате json, который вы хотите конвертировать    
`output-folder` - папка куда будет записан созданный файл    
`ann-name` - название созданного файла    
`attitude` - отношение `train` и `test`

## cvt_yaml_to_json.ipynb
Этот скрипт конвертирует yaml файлы в JSON формат.    
В этой строчке требуется указать удобный вам путь:    
`ymls = glob.glob("/disks/ssd/Datasets/Traffic_lights/DTLD_Labels/*yml")`   

## *.ipynb
Файлы типа `ipynb` предназначены для обучения классификатор светофоров.    
Все ноутбуки используют KERAS    
Из названия ноутбука можно понять размерность тензора подаваемого на классификатор (200/128/71)   
Цифра после `xception` в названии файла определяет по какому признаку наша сетка будет классифицировать  
